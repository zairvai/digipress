import React from 'react'
import {connect} from 'react-redux'
import {	
	VuroxTableDark
} from 'Components/tables'
import {Button,Tooltip} from 'antd'
import Icon from '@mdi/react'
import {mdiDelete} from '@mdi/js'

import { bindPromiseCreators } from 'redux-saga-routines';
import { listTagsRoutinePromise } from 'State/routines/tag';
import TagController from 'Library/controllers/TagController'

const List = ({accountId,...props}) =>{

    const {listTags} = props

    const tagController = new TagController(props)

    React.useEffect(async ()=>{
		
		try{

			await listItems({accountId})

		}catch(error){
			console.log(error)
		}

    },[accountId])
    
    const listItems = async ({accountId,name=false,orderBy="createdAt",direction="asc",from=0,size=50}) => {

        try{

            await tagController._list({
                accountId,
                name,
                orderBy,
                direction,
                from,size})

        }catch(error){
            console.log(error)
        }

    }

    const RowItem = ({item,index}) => (
        <tr>
            <td valign="middle">{index+1}</td>
            <td valign="middle">{item.name}</td>
            <td valign="middle" className="fright">
                <Tooltip placement="topLeft" title="Hapus" arrowPointAtCenter>
                    <Button type="link" icon={<Icon size="1.3em" path={mdiDelete}/>}  onClick={()=>props.onDelete(item,index)}/>
                </Tooltip>
            </td>
        </tr>
    )

    return(
        <VuroxTableDark>
            <table className="table table-borderless">
                <thead>
                    <tr>
                        <th width="20"></th>
                        <th width="25%">Tag</th>
                        <th className="fright"></th>
                    </tr>
                </thead>
                <tbody>
                    {   listTags.list.items ?
                            listTags.list.items.map((item,index)=><RowItem key={`${item.name}${item.id}`} index={index} item={item}/>)
                            :
                            <></>
                    }
                </tbody>
            </table>
            
        </VuroxTableDark>
    )

}

const Page =  connect(
    state=>state,
    (dispatch)=>({
            ...bindPromiseCreators({
				listTagsRoutinePromise
        },dispatch),dispatch
    })
)(List)

export default React.memo(Page)